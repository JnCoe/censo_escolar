---
title: "Cronograma"
author: "Jonas Coelho"
date: "04/11/2021"
output:
  html_document:
    theme: cosmo
    toc: yes
    toc_float:
      collapsed: no
    number_sections: yes
    df_print: paged
    code_folding: hide
    self_contained: false
  word_document:
    toc: yes
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(message = FALSE)
```

```{css, echo=FALSE}
pre:not(.r) {
  color: #b0b0b0;
}
```


Carregando bibliotecas
```{r}
library(dplyr)
library(ggplot2)
library(knitr)
library(kableExtra)
library(hrbrthemes)
library(viridis)
library(gridExtra)

options(scipen = 9999)
load('../dados/cronograma.rdata')
load('../dados/novo_cronograma.rdata')
load('../dados/novo_cronograma3.rdata')

novo_cronograma <- novo_cronograma3 %>%
  janitor::clean_names()
```


# Dados 2021


## Rede municipal 2

```{r, results='asis'}
graf <- novo_cronograma %>%
  mutate(hibrido = as.numeric(hibrido),
         presencial = as.numeric(presencial)) %>% filter(rede == 'Municipal') %>%
  select(!rede) %>%
  googleVis::gvisBarChart(
    xvar = 'capital',
    options = list(
      bars = 'horizontal',
      isStacked = TRUE,
      height = 700,
      focusTarget = 'category',
      colors = "['#527184', '#62b5ea', '#f6a323']",
      fontName = 'Source Sans Pro',
      fontSize = 14.4,
      chartArea = "{height:\"90%\"}"
    )
  )


print(graf, "chart")
```

## Rede estadual 2

```{r, results='asis'}
graf <- novo_cronograma %>%
  mutate(hibrido = as.numeric(hibrido),
         presencial = as.numeric(presencial)) %>% filter(rede == 'Estadual') %>%
  select(!rede) %>%
  googleVis::gvisBarChart(
    xvar = 'capital',
    options = list(
      bars = 'horizontal',
      isStacked = TRUE,
      height = 1080,
      focusTarget = 'category',
      colors = "['#527184', '#62b5ea', '#f6a323']",
      fontName = 'Source Sans Pro',
      fontSize = 14.4,
      chartArea = "{height:\"90%\"}"
    )
  )

print(graf, "chart")
```


# Médias estaduais

```{r}
novo_cronograma_estadual <- novo_cronograma %>%
  filter(rede == 'Estadual')

novo_cronograma_municipal <- novo_cronograma %>%
  filter(rede == 'Municipal')
```

```{r, fig.height=11}
g1 <- novo_cronograma_estadual %>%
  rowwise() %>%
  mutate(total_dias = sum(remoto+hibrido+presencial)) %>%
ggplot(aes(y=presencial, x=reorder(capital, -presencial, desc), fill=as.factor(regiao) )) + 
  geom_col( ) +
  scale_fill_brewer(palette = "Set1") +
  theme(axis.text.x = element_text(angle = 90, vjust = 1, hjust=1), legend.position = 'none') +
  coord_flip()

g2 <- novo_cronograma_estadual %>%
  rowwise() %>%
  mutate(total_dias = sum(remoto+hibrido+presencial)) %>%
ggplot(aes(y=hibrido, x=reorder(capital, -hibrido, desc), fill=as.factor(regiao) )) + 
  geom_col( ) +
  scale_fill_brewer(palette = "Set1") +
  theme(axis.text.x = element_text(angle = 90, vjust = 1, hjust=1), legend.position = 'none') +
  coord_flip()

g3 <- novo_cronograma_estadual %>%
  rowwise() %>%
  mutate(total_dias = sum(remoto+hibrido+presencial)) %>%
ggplot(aes(y=remoto, x=reorder(capital, -remoto, desc), fill=as.factor(regiao) )) + 
  geom_col( ) +
  scale_fill_brewer(palette = "Set1") +
  theme(legend.position = 'none') +
  coord_flip()

g4 <- novo_cronograma_estadual %>%
  rowwise() %>%
  mutate(total_dias = sum(remoto+hibrido+presencial)) %>%
ggplot(aes(y=total_dias, x=reorder(capital, -total_dias, desc), fill=as.factor(regiao))) + 
  geom_col( ) +
  scale_fill_brewer(palette = "Set1") +
  theme(axis.text.x = element_text(angle = 90, vjust = 1, hjust=1), legend.position = 'none') +
  coord_flip()

grid.arrange(g1, g2, g3, g4)
```

Em média, as escolas públicas estaduais brasileiras tiveram 86 dias de aulas remotas, 63 de aulas no formato híbrido e 46 no formato presencial. Enquanto as regiões Norte, Nordeste e Centro-oeste tiveram uma média de no mínimo 89 dias de aulas remotas, as regiões sul e sudeste tiveram em média apenas 33 e 55 dias letivos nessa modalidade.

Essa diferença se deve a uma maior predominância do modelo híbrido nessas duas regiões, especificamente em São Paulo, que aplicou ensino híbrido por 150 dias letivos. No caso do ensino presencial, apesar de haver novamente predominância das regiões sul e sudeste perante às demais, a diferença na média é menor. Chama atenção o caso do Amazonas, com mais de 100 dias letivos nessa modalidade nessa modalidade, m número considerável quando comparado aos demais estados.

Em relação aos dias totais letivos, a maior parte dos estados (22 ou 81%) o cronograma estabelecido pelo estado foi de 200 dias letivos ou mais. 5 estados não somaram esse valor para o ano letivo: Acre, Rio Grande do Norte, Roraima, Tocantis e Espírito Santo.




